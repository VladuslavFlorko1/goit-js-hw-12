{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '52837655-6c21f27bf556d895abe6a0fd0';\nconst PER_PAGE = 15;\n\nconst api = axios.create({\n  baseURL: 'https://pixabay.com/api/',\n  params: {\n    key: API_KEY,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    per_page: PER_PAGE,\n  },\n});\n\nexport async function getImagesByQuery(query, page = 1) {\n  const { data } = await api.get('', { params: { q: query, page } });\n  return data;\n}\n\nexport { PER_PAGE };\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst galleryEl = document.getElementById('gallery');\nconst loadMoreBtn = document.getElementById('load-more');\nconst loaderEl = document.getElementById('loader');\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 200,\n});\n\nexport function createGallery(images) {\n  const markup = images\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `\n<li class=\"photo-card\">\n  <a href=\"${largeImageURL}\">\n    <img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n  </a>\n  <div class=\"info\">\n    <div><b>Likes</b>${likes}</div>\n    <div><b>Views</b>${views}</div>\n    <div><b>Comments</b>${comments}</div>\n    <div><b>Downloads</b>${downloads}</div>\n  </div>\n</li>`\n    )\n    .join('');\n\n  galleryEl.insertAdjacentHTML('beforeend', markup);\n  lightbox.refresh();\n}\n\nexport function clearGallery() {\n  galleryEl.innerHTML = '';\n}\nexport function showLoader() {\n  loaderEl.classList.remove('is-hidden');\n}\nexport function hideLoader() {\n  loaderEl.classList.add('is-hidden');\n}\nexport function showLoadMoreButton() {\n  loadMoreBtn.classList.remove('is-hidden');\n}\nexport function hideLoadMoreButton() {\n  loadMoreBtn.classList.add('is-hidden');\n}\n\nexport const refs = { galleryEl, loadMoreBtn };\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport { getImagesByQuery, PER_PAGE } from './js/pixabay-api.js';\nimport {\n  createGallery,\n  clearGallery,\n  showLoader,\n  hideLoader,\n  showLoadMoreButton,\n  hideLoadMoreButton,\n  refs,\n} from './js/render-functions.js';\n\nconst form = document.getElementById('search-form');\n\nlet state = {\n  query: '',\n  page: 1,\n  totalHits: 0,\n  isLoading: false,\n};\n\nform.addEventListener('submit', onSearchSubmit);\nrefs.loadMoreBtn.addEventListener('click', onLoadMore);\n\nasync function onSearchSubmit(e) {\n  e.preventDefault();\n  const query = e.currentTarget.elements.search.value.trim();\n  if (!query) {\n    iziToast.info({ message: 'Введіть слово для пошуку!' });\n    return;\n  }\n\n  state = { query, page: 1, totalHits: 0, isLoading: false };\n  clearGallery();\n  hideLoadMoreButton();\n  await loadImages();\n}\n\nasync function onLoadMore() {\n  await loadImages(true);\n}\n\nasync function loadImages(isLoadMore = false) {\n  if (state.isLoading) return;\n  state.isLoading = true;\n  showLoader();\n\n  try {\n    const { totalHits, hits } = await getImagesByQuery(state.query, state.page);\n\n    if (state.page === 1 && totalHits === 0) {\n      hideLoadMoreButton();\n      iziToast.warning({ message: 'Нічого не знайдено.' });\n      return;\n    }\n\n    createGallery(hits);\n\n    if (state.page === 1) {\n      state.totalHits = totalHits;\n      iziToast.success({ message: `Знайдено ${totalHits} зображень.` });\n    }\n\n    const shown = state.page * PER_PAGE;\n    const noMore = shown >= state.totalHits || hits.length < PER_PAGE;\n\n    if (noMore) {\n      hideLoadMoreButton();\n      iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n    } else {\n      showLoadMoreButton();\n    }\n\n    if (isLoadMore && hits.length) scrollSmoothly();\n    state.page += 1;\n  } catch (err) {\n    console.error(err);\n    iziToast.error({ message: 'Помилка запиту. Перевір ключ або мережу.' });\n  } finally {\n    hideLoader();\n    state.isLoading = false;\n  }\n}\n\nfunction scrollSmoothly() {\n  const firstCard = refs.galleryEl.firstElementChild;\n  if (!firstCard) return;\n  const { height } = firstCard.getBoundingClientRect();\n  window.scrollBy({ top: height * 2, behavior: 'smooth' });\n}\n"],"names":["API_KEY","PER_PAGE","api","axios","getImagesByQuery","query","page","data","galleryEl","loadMoreBtn","loaderEl","lightbox","SimpleLightbox","createGallery","images","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","clearGallery","showLoader","hideLoader","showLoadMoreButton","hideLoadMoreButton","refs","form","state","onSearchSubmit","onLoadMore","e","iziToast","loadImages","isLoadMore","totalHits","hits","scrollSmoothly","err","firstCard","height"],"mappings":"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"}